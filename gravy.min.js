Backbone.Gravy=Backbone.View.extend({_VERSION:"1.0",_reservedNames:{success:"success",error:"error",clear:"clear",submit:"submit"},_validatingAll:!1,_reserved:function(b){for(var c in this._reservedNames)if(b===this._reservedNames[c])return!0;return!1},_assertCallback:function(b,c){if(!c)throw Error("[GRAVY] "+b);},_validateAttribute:function(b,c){var d=this.gravy,e=null,h=null,a=null,g=!1,f=d[b],a=f instanceof Object?f:this[f]||this.model[f];this._assertCallback("Unable to find validator for: ",
a,b);if(_.isObject(a)&&!_.isFunction(a)&&(a.optional&&(g=!0),e=a.success,h=a.error,a=a.validator,!_.isFunction(a)&&(a=this[a]||this.model[a],!a)))throw Error("[Gravy] Unable to find validator for: "+b);return{result:!c&&g||a.call(this[f]?this:this.model,c),success:e||d.success||this[this._reservedNames.success],error:h||d.error||this[this._reservedNames.error]}},_applyCallback:function(b,c){var d=b.result?b.success:b.error,d=_.isFunction(d)?d:this[d];this._assertCallback("Unable to find callback: ",
d,b);return d.call(this,c)},validate:function(b){var c,d,e;d=$(b.target);c=b.target.value;e=this.gravy;if(!this._validatingAll&&!c.length)return c=_.isFunction(e.clear)?e.clear:this[e.clear]||this[this._reservedNames.clear],this._assertCallback("Unable to find clear callback!",c),c.call(this,d);b=b.target.name;if(!e[b])return console.log("[Gravy] Did not find "+b+" in gravy hash");c=this._validateAttribute(b,c);return this._applyCallback(c,d)},validateAll:function(b){b.preventDefault();var c=!0,d=
this.gravy,e=d.submit,h={},a,g;this._validatingAll=!0;for(var f in d)this._reserved(f)||(g=this.$("[name='"+f+"']"),d=g.val(),a=this._validateAttribute(f,d),a.result||(c=!1),h[f]=d,this._applyCallback(a,g));this._validatingAll=!1;if(!c&&(a=_.isFunction(e.error)?e.error:this[e.error],!a))return;c&&(a=_.isFunction(e.success)?e.success:this[e.success],this._assertCallback("Unable to find submission success callback!",a));return a.call(this,h,$(b.target))}});
