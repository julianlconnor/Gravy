Backbone.Gravy=Backbone.View;
_.extend(Backbone.Gravy.prototype,{_VERSION:"1.0",_r:{success:"success",error:"error",clear:"clear",submit:"submit"},_v:!1,_reserved:function(a){for(w in this._r)if(a===this._r[w])return!0;return!1},_validateNode:function(a,b){var c=this.gravy,d=null,e=null,f=c[a];if(!(validator=f instanceof Object?f:this[f]||this.model[f]))throw Error("[Gravy] Unable to find validator for: "+a);if(_.isObject(validator)&&!_.isFunction(validator)&&(d=validator.success,e=validator.error,!(validator=validator.validator)||
!(validator=this[validator]||this.model[validator])))throw Error("[Gravy] Unable to find validator for: "+a);return{result:validator.apply(this,[b]),success:d||c.success||this[this._r.success],error:e||c.error||this[this._r.error]}},_applyCallback:function(a,b){a=a.result?a.success:a.error;_.isFunction(a)||(a=this[a]);return a.apply(this,[b])},validate:function(a){var b,c,d;c=$(a.target);b=a.target.value;d=this.gravy;if(!this._v&&!b.length){if(!d.clear&&!this[this._r.clear])throw Error("[Gravy] Unable to find clear callback!");
return this[d.clear||this._r.clear].apply(this,[c])}a=a.target.name;if(!d[a])return console.error("[Gravy] Did not find "+a+" in gravy hash");b=this._validateNode(a,b);return this._applyCallback(b,c)},validateAll:function(a){a.preventDefault();var b=!0,c=this.gravy,d=c.submit,e;this._v=!0;for(field in c)this._reserved(field)||(e=this.$("#"+field),c=e.val(),callback=this._validateNode(field,c),callback.result||(b=!1),this._applyCallback(callback,e));this._v=!1;if(b||this[d.error]){if(b&&!this[d.success])throw Error("[Gravy] Unable to find submission success callback!");
return this[b?d.success:d.error].apply(this,[$(a.target)])}}});
