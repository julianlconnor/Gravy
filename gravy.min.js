Backbone.Gravy=Backbone.View;
_.extend(Backbone.Gravy.prototype,{_VERSION:"1.0",_r:{success:"success",error:"error",clear:"clear",submit:"submit"},_v:!1,_reserved:function(a){for(w in this._r)if(a===this._r[w])return!0;return!1},_validateNode:function(a,d){var c=this.gravy,e=null,f=null,b=c[a];if(!(validator=b instanceof Object?b:this[b]||this.model[b]))throw Error("[Gravy] Unable to find validator for: "+a);if(_.isObject(validator)&&!_.isFunction(validator)&&(e=validator.success,f=validator.error,!(validator=validator.validator)||
!(validator=this[validator]||this.model[validator])))throw Error("[Gravy] Unable to find validator for: "+a);return{result:validator.apply(this[b]?this:this.model,[d]),success:e||c.success||this[this._r.success],error:f||c.error||this[this._r.error]}},_applyCallback:function(a,d){a=a.result?a.success:a.error;if(!_.isFunction(a)&&!(a=this[a]))throw Error("[Gravy] Unable to find callback: "+a);return a.apply(this,[d])},validate:function(a){var d,c,e,f;e=$(a.target);d=a.target.value;f=this.gravy;if(!this._v&&
!d.length){if(!(c=f.clear)||!(c=_.isFunction(c)?c:this[f.clear]||this[this._r.clear]))throw Error("[Gravy] Unable to find clear callback!");return c.apply(this,[e])}a=a.target.name;if(!f[a])return console.log("[Gravy] Did not find "+a+" in gravy hash");d=this._validateNode(a,d);return this._applyCallback(d,e)},validateAll:function(a){a.preventDefault();var d=!0,c=this.gravy,e=c.submit,f={},b,g;this._v=!0;for(field in c)this._reserved(field)||(g=this.$("#"+field),c=g.val(),b=this._validateNode(field,
c),b.result||(d=!1),f[field]=c,this._applyCallback(b,g));this._v=!1;if(d||(b=e.error)&&(b=_.isFunction(b)?b:this[e.error])){if(d&&(!(b=e.success)||!(b=_.isFunction(b)?b:this[e.success])))throw Error("[Gravy] Unable to find submission success callback!");return b.apply(this,[f,$(a.target)])}}});
