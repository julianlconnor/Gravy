Backbone.Gravy=Backbone.View;
_.extend(Backbone.Gravy.prototype,{_VERSION:"1.0",_r:{success:"success",error:"error",clear:"clear",submit:"submit"},_v:!1,_reserved:function(a){for(w in this._r)if(a===this._r[w])return!0;return!1},_validateNode:function(a,b){var d=this.gravy,e=null,g=null,c=!1,f=d[a];if(!(validator=f instanceof Object?f:this[f]||this.model[f]))throw Error("[Gravy] Unable to find validator for: "+a);if(_.isObject(validator)&&!_.isFunction(validator)&&(validator.optional&&(c=!0),e=validator.success,g=validator.error,
validator=validator.validator,!_.isFunction(validator)&&(!(validator=validator.validator)||!(validator=this[validator]||this.model[validator]))))throw Error("[Gravy] Unable to find validator for: "+a);return{result:!b&&c||validator.apply(this[f]?this:this.model,[b]),success:e||d.success||this[this._r.success],error:g||d.error||this[this._r.error]}},_applyCallback:function(a,b){a=a.result?a.success:a.error;if(!_.isFunction(a)&&!(a=this[a]))throw Error("[Gravy] Unable to find callback: "+a);return a.apply(this,
[b])},validate:function(a){var b,d,e;d=$(a.target);b=a.target.value;e=this.gravy;if(!this._v&&!b.length){if(!(b=_.isFunction(e.clear)?e.clear:this[e.clear]||this[this._r.clear]))throw Error("[Gravy] Unable to find clear callback!");return b.apply(this,[d])}a=a.target.name;if(!e[a])return console.log("[Gravy] Did not find "+a+" in gravy hash");b=this._validateNode(a,b);return this._applyCallback(b,d)},validateAll:function(a){a.preventDefault();var b=!0,d=this.gravy,e=d.submit,g={},c,f;this._v=!0;for(field in d)this._reserved(field)||
(f=this.$("[name='"+field+"']"),d=f.val(),c=this._validateNode(field,d),c.result||(b=!1),g[field]=d,this._applyCallback(c,f));this._v=!1;if(b||(c=e.error)&&(c=_.isFunction(c)?c:this[e.error])){if(b&&(!(c=e.success)||!(c=_.isFunction(c)?c:this[e.success])))throw Error("[Gravy] Unable to find submission success callback!");return c.apply(this,[g,$(a.target)])}}});
